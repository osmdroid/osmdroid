<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2016-02-23 
 | Rendered using Apache Maven Fluido Skin 1.4
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="Date-Creation-yyyymmdd" content="20080101"/>
    <meta name="Date-Revision-yyyymmdd" content="20180716"/>
    <meta http-equiv="Content-Language" content="en"/>
    <title> osmdroid</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.4.min.css"/>
    <link rel="stylesheet" href="./css/site.css"/>
    <link rel="stylesheet" href="./css/print.css" media="print"/>

    <link rel="stylesheet" type="text/css" href="./css/bootstrap-sortable.css">


    <script type="text/javascript" src="./js/jquery-1.12.4.min.js"></script>
    <script type="text/javascript" src="./js/apache-maven-fluido-1.4.min.js"></script>
    <script type="text/javascript" src="./js/bootstrap-sortable.js"></script>
    <script type="text/javascript" src="./js/moment.min.js"></script>
</head>
<body class="topBarDisabled">

<a href="https://github.com/osmdroid/osmdroid">
    <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
    src="./img/forkme_right_gray_6d6d6d.png"
    alt="Fork me on GitHub">
    </a>


<div class="container-fluid">
    <div id="banner">
        <div class="pull-left">
            <div id="bannerLeft">
                <h2> osmdroid</h2>
            </div>
        </div>
        <div class="pull-right">
            <div id="bannerRight">
                <!-- override this with your own logo-->
                <img src="./img/logo.png"/>
            </div>
        </div>
        <div class="clear">
            <hr/>
        </div>
    </div>

    <div id="breadcrumbs">
        <ul class="breadcrumb">

            <li class="">
                <a href="https://github.com/osmdroid/" class="externalLink" title="org.osmdroid">
                    org.osmdroid</a>
                <span class="divider">/</span>
            </li>
            <li class="">
                <a href="https://github.com/osmdroid/osmdroid" class="externalLink" title="osmdroid">
                    osmdroid</a>

            </li>

            <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published:
                2018-07-16
            </li>
            <li id="projectVersion" class="pull-right">
                6.0.2
            </li>

        </ul>
    </div>


    <div class="row-fluid">
        <div id="leftColumn" class="span2">
            <div class="well sidebar-nav">


                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>

                    <li  >

                        <a href="index.html"><span class="none"></span>Introduction</a>
                    </li>

                    <!-- user generated menu goes here, basically any additional html or markdown files
                    from src/site are auto linked here-->

					<li><a href="Home.html" title="Home"><span class="none"></span>Home</a>
						<ul class="nav nav-list">
							<li><a href="How-to-include-OsmDroid-in-a-Maven-Android-project.html" title="How   to   include   Osm Droid   in   a   Maven   Android   project"><span class="none"></span>How   to   include   Osm Droid   in   a   Maven   Android   project</a></li> 
							<li><a href="How-to-include-OsmDroid-in-a-non-Gradle,-non-Maven-project.html" title="How   to   include   Osm Droid   in   a   non   Gradle ,   non   Maven   project"><span class="none"></span>How   to   include   Osm Droid   in   a   non   Gradle ,   non  Maven   project</a></li> 
							<li><a href="Prerequisites.html" title="Prerequisites"><span class="none"></span>Prerequisites</a></li> 
							<li><a href="How-to-use-the-osmdroid-library.html" title="How   to   use   the   osmdroid   library"><span class="none"></span>How   to   use   the   osmdroid   library</a></li> 
						</ul>
					</li>                    
					
					 <li class="nav-header"><span class="icon-chevron-down"></span>Usage Guides</li>
					 <li>
						<ul class="nav nav-list">
							<li><a href="How-to-use-the-osmdroid-library.html" title="How   to   use   the   osmdroid   library"><span class="none"></span>How   to   use   the   osmdroid   library</a></li>  
							<li><a href="Markers,-Lines-and-Polygons.html" title="Markers ,   Lines   and   Polygons"><span class="none"></span>Markers ,   Lines   and   Polygons</a></li> 
							<li><a href="Geopackage-Support.html" title="Geopackage   Support"><span class="none"></span>Geopackage   Support</a></li> 
							<li><a href="Cache-Manager.html" title="Cache   Manager"><span class="none"></span>Cache   Manager</a></li> 
							<li><a href="WMS-Support.html" title="WMS   Support"><span class="none"></span>WMS   Support</a></li>	
							<li><a href="Tile-Caching.html" title="Tile   Caching"><span class="none"></span>Tile   Caching</a></li> 
							<li><a href="osmdroid-thirdparty.html" title="Osmdroid   thirdparty"><span class="none"></span>Osmdroid   thirdparty</a></li> 
							<li><a href="Mapsforge.html" title="Mapsforge"><span class="none"></span>Mapsforge</a></li> 
						 </ul>
					 </li>
					 
					<li class="nav-header"><span class="icon-chevron-down"></span>Upgrades and Changes</li>
					 <li>
						<ul class="nav nav-list">
							<li><a href="Upgrade-Guide.html" title="Upgrade   Guide"><span class="none"></span>Upgrade   Guide</a></li> 
							<li><a href="Changelog.html" title="Changelog"><span class="none"></span>Changelog</a></li> 
						 </ul>
					 </li>

				     <li class="nav-header"><span class="icon-chevron-down"></span>Architecture and Design</li>
					 <li>
						<ul class="nav nav-list">
							<li><a href="Modular-Tile-Provider-Architecture.html" title="Modular   Tile   Provider   Architecture"><span class="none"></span>Modular   Tile   Provider   Architecture</a></li> 
							<li><a href="Map-Sources.html" title="Map   Sources"><span class="none"></span>Map   Sources</a></li> 
							<li><a href="Offline-Map-Tiles.html" title="Offline   Map   Tiles"><span class="none"></span>Offline   Map   Tiles</a></li> 	
						</ul>
					</li>
					 
					 
					<li class="nav-header"><span class="icon-chevron-down"></span>Q&A</li>
					 <li>
						<ul class="nav nav-list">
							<li><a href="How-big-is-it.html" title="How   big   is   it"><span class="none"></span>How   big   is   it</a></li> 
							<li><a href="Capabilities.html" title="Capabilities"><span class="none"></span>Capabilities</a></li> 
							<li><a href="Important-notes-on-using-osmdroid-in-your-app.html" title="Important   notes   on   using   osmdroid   in   your   app"><span class="none"></span>Important   notes   on   using   osmdroid   in   your   app</a></li> 
							<li><a href="FAQ.html" title="FAQ"><span class="none"></span>FAQ</a></li> 
						</ul>
					 </li>
					 
					<li class="nav-header"><span class="icon-chevron-down"></span>Other Information</li>
					 <li>
						<ul class="nav nav-list">
							<li><a href="Applications-Using-osmdroid.html" title="Applications Using osmdroid"><span class="none"></span>Applications   Using   osmdroid</a></li> 
							<li><a href="Related-Projects.html" title="Related   Projects"><span class="none"></span>Related   Projects</a></li>
						 </ul>
					 </li>
					
					<li class="nav-header"><span class="icon-chevron-down"></span>Committer Notes</li>
					 <li>
							<ul class="nav nav-list">
								<li><a href="Developer-Guidelines.html" title="Developer   Guidelines"><span class="none"></span>Developer   Guidelines</a></li> 
								<li><a href="How-to-build-osmdroid-from-source.html" title="How   to   build   osmdroid   from   source"><span class="none"></span>How   to   build   osmdroid   from   source</a></li> 
								<li><a href="Debugging-osmdroid.html" title="Debugging   osmdroid"><span class="none"></span>Debugging   osmdroid</a></li> 
								<li><a href="Release-Procedure.html" title="Release   Procedure"><span class="none"></span>Release   Procedure</a></li> 
							 </ul>
					 </li>
 
                    <li class="nav-header">Project Documentation</li>

                    <li>

                        <a href="project-info.html" title="Project Information">
                            <span class="icon-chevron-down"></span>
                            Project Information</a>
                        <ul class="nav nav-list">

                            <li>

                                <a href="team-list.html" title="Project Team">
                                    <span class="none"></span>
                                    Project Team</a>
                            </li>

                            <li>

                                <a href="scm:git:git@github.com:osmdroid/osmdroid.git" title="Source Repository">
                                    <span class="none"></span>
                                    Source Repository</a>
                            </li>

                            <li>

                                <a href="https://github.com/osmdroid/osmdroid/issues" title="Issue Tracking">
                                    <span class="none"></span>
                                    Issue Tracking</a>
                            </li>
                            <li>

                                <a href="project-license.html" title="Project License">
                                    <span class="none"></span>
                                    Project License</a>
                            </li>

                            <li>

                                <a href="dependency-repos.html" title="Dependency Repositories">
                                    <span class="none"></span>
                                    Dependency Repositories</a>
                            </li>


                            <li>

                                <a href="dependencyReport.html" title="Dependency Convergence">
                                    <span class="none"></span>
                                    Dependency Convergence</a>
                            </li>

                            <!-- maybe in the future
                                                        <li>

                                                            <a href="mail-lists.html" title="Mailing Lists">
                                                                <span class="none"></span>
                                                                Mailing Lists</a>
                                                        </li>

                                                        <li>

                                                            <a href="dependency-management.html" title="Dependency Management">
                                                                <span class="none"></span>
                                                                Dependency Management</a>
                                                        </li>


                            -->
                            <li>

                                <a href="https://travis-ci.org/osmdroid/osmdroid" title="Continuous Integration">
                                    <span class="none"></span>
                                    Continuous Integration</a>
                            </li>
                            <!--
                                                        <li>

                                                            <a href="plugins.html" title="Project Plugins">
                                                                <span class="none"></span>
                                                                Project Plugins</a>
                                                        </li>
                            -->
                            <li>

                                <a href="https://github.com/osmdroid/osmdroid/releases"
                                   title="Distribution Management">
                                    <span class="none"></span>
                                    Distribution Management</a>
                            </li>
                            <li>

                                <a href="javadoc.html" title="Project Reports">
                                    <span class="none"></span>
                                    Javadocs</a>

                            </li>

                            <li>

                                <a href="reports.html" title="Project Reports">
                                    <span class="none"></span>
                                    Project Reports</a>

                            </li>

                        </ul>
                    </li>


                </ul>


                <hr/>


            </div>
        </div>


        <div id="bodyColumn" class="span10">
            <a name="topOfPage"></a>
            <p>** Notice: This article is still being written and targets osmdroid v6.0.0 and higher**</p>
<h1>Making Custom Overlays</h1>
<h2>Introduction</h2>
<p>An overlay is similar to a paper map with acetate overlay on top of it. Overlays are responsible for drawing/rendering content on the screen (what you see on an Android device). This article describes some common pitfalls, coordinate systems, and common procedures that you will need for creating a custom overlay. This is an advanced topic and care must be taken to optimize performance.</p>
<h3>Hello World of Overlays</h3>
<p>In your favorite IDE or text editor, make a new class that extend the class <code>org.osmdroid.views.overlay.Overlay</code>. It will make you implement the following method:</p>
<pre><code>@Override
public void draw(Canvas canvas, MapView map, boolean shadow) {
 if (!isEnabled()) return;
 if (shadow) { 
   //draw a shadow if needed, otherwise return
   return;
 }
 //draw your stuff here
}
</code></pre>
<h2>Understanding the Draw cycle</h2>
<p>First of all, the draw cycle happens on the UI thread. It's the only thread that's allowed to manipulate the user interface in an android application. Optimization is import for rendering speeds.</p>
<p>The Draw Cycle is what we (osmdroid) refer to as the process of rendering the map on screen. When one of the following conditions occurs, the draw cycle will start.</p>
<ul>
<li><code>MapView#invalidate</code> is called</li>
<li>The zoom level changes</li>
<li>The map's view port changes (panning, rotation)</li>
<li>Android life cycle events that cause invalidate to occur</li>
</ul>
<p>The <code>Overlay#draw</code> method is called twice on every draw cycle. Once for the <code>shadow</code> and once for the <code>overlay</code> itself.</p>
<p>As you can image, this happens frequently.</p>
<h2>Drawing Static UI elements</h2>
<p>Static elements UI do not move with the map panning, zooming or rotation. This can be used for maps controls, minimaps, etc, however custom UI elements are often best implemented using android layouts, buttons, widgets, etc. But if you need them map integrated, it's completely feasible.</p>
<p>Here's an example taken from <code>CopyrightOverlay</code>.</p>
<pre><code>Paint paint = new Paint();
....
map.getProjection().save(canvas, false, false);
//draw here
canvas.drawText(map.getTileProvider().getTileSource().getCopyrightNotice(), x, y, paint);
map.getProjection().restore(canvas, false);
</code></pre>
<p>This draws at the on screen pixel coordinate point of x,y using the <code>paint</code> object's styling.</p>
<h2>Drawing geospatially referenced elements</h2>
<p>These elements scale on zoom, rotate with rotation, and pan with the map as if they are anchored to it.</p>
<p>Assuming your &quot;stuff to draw on screen&quot; has some kind of geo point associated with it, the first thing you'll probably need to do is to figure out if your stuff needs to be drawn on screen.</p>
<pre><code>final Projection pj = mapView.getProjection();
</code></pre>
<p>The <code>Projection</code> class is super important and provides the ability to convert to/from</p>
<ul>
<li>Integer Screen pixel coordinates</li>
<li>Long Canvas coordinates</li>
<li>Double Latitude/Longitude coordinates</li>
</ul>
<p>Most if the time, you'll need some code that looks like this:</p>
<pre><code>canvas.save();
//draw here
canvas.restore();

</code></pre>
<p>This will draw your stuff oriented in the same direction as the map (osmdroid can rotate the map so that north is in any direction needed).</p>
<h2>Handling Android Lifecycle Events</h2>
<h3>onDetach</h3>
<p>This is required for releasing resources. This happens when</p>
<ul>
<li>Your overlay is removed from the map view</li>
<li>When the map view is destroyed</li>
</ul>
<h3>onPause and onResume</h3>
<p>This happens when</p>
<ul>
<li>MapView#onPause() is called</li>
<li>MapView#onResumse() is called</li>
</ul>
<h3>Handing user input</h3>
<p>The <code>Overlay</code> class has a whole bunch of methods you can override in order to support different types of user input, such as touch, long press, short press, mouse actions, scrolling, etc.</p>
<p>It is often that you may want to perform some kind of &quot;hit test&quot; in your code, specifically on press/tap events. This is useful for when a user clicks on your map &quot;thing&quot;. For non-static elements, you'll want to take the user point <code>Point</code>, which is on screen pixel coordinates, then use the <code>Projection</code> class's methods to convert the <code>Point</code> to a <code>GeoPoint</code> then make your own comparisons in order to determine if your overlay should handle the event.</p>


        </div>
        <div id="iframenav" style="visibility:hidden">
            <center><h3><a name="iframeAnchor"></a><a href="#topOfPage"> -- Top --</a></h3>
                <a href="javascript:popout();">Load in a new window</a>
            </center>
        </div>

        <iframe id="frame1" width="100%" height="75%" style="display:none"></iframe>



    </div>
</div>

<hr/>

<footer>
    <div class="container-fluid">
        <div class="row-fluid">
            <!-- footer -->
        </div>


    </div>
</footer>

<div class="modal hide fade" id="modal1">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h3>Artifact Details</h3>
    </div>
    <div class="modal-body">
        <h3>Gradle</h3>
        <pre id="gradleDep">

        </pre>
        <h3>Maven</h3>
        <pre id="mavenDep">

        </pre>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal" >Close</a>
    </div>
</div>

<script type="text/javascript">

/**
*    opens the current iframe url in a new window or tab
*/
function popout(){
    var destination = $("#frame1").attr('src');
    var win = window.open(destination, '_blank');
    win.focus();
}

/**
*    displays a report and shows the iframe
*/
function showReport(url){
    $("#iframenav").css('visibility','');
    $("#frame1").show();
    $("#frame1").attr('src', url);
    $("#frame1").attr('height', window.innerHeight);
    window.location.assign("#iframeAnchor");
}

/**
* shows our maven/gradle helper modal
type is the file extension
*/
function showModal(group, artifact, version,type, classifier){

/**
if classifier and types
    foreach classifier
        foreach types
else if classifier
    foreach classifier
else if type
    foreah type
else
    just output it
*/
    //string outputs
    var maventxt ="";
    var gradle="";

    var hasClassifiers = classifier !== "" && classifier !== undefined;
    var hasTypes = type !== "" && type !== undefined;

    if (hasClassifiers && hasTypes){
        type = type.trim();
        var types = type.split(" ");
        classifier = classifier.trim();
        var classifiers = classifier.split(" ");
        for (var i = 0; i < types.length; i++) {
            if (types[i].trim().length==0)
                continue;
            for (var k = 0; k < classifiers.length; k++) {
                if (classifiers[k].trim().length==0)
                    continue;
                maventxt+= "<dependency>\n\t<groupId>" + group + "</groupId>\n\t<artifactId>" + artifact+
                    "</artifactId>\n\t";
                maventxt += "<type>" + types[i].trim() + "</type>\n\t";
                maventxt += "<classifier>" + classifiers[k].trim() + "</classifier>\n\t";
                maventxt +="<version>" + version + "</version>\n</dependency>\n";

                gradle += "compile '" + group + ":" + artifact + ":" + version;
                gradle += ":" + classifiers[k].trim();
                gradle += "@" + types[i];
                gradle += "'\n";
            }

        }


    } else if (hasClassifiers) {
        classifier = classifier.trim();
        var types = classifier.split(" ");
        for (var i = 0; i < types.length; i++) {
            if (types[i].trim().length==0)
                continue;
            maventxt+= "<dependency>\n\t<groupId>" + group + "</groupId>\n\t<artifactId>" + artifact+
                "</artifactId>\n\t";
            maventxt += "<classifier>" + types[i].trim() + "</classifier>\n\t";
            maventxt +="<version>" + version + "</version>\n</dependency>\n";

            gradle += "compile '" + group + ":" + artifact + ":" + version;
            gradle += ":" + types[i];
            gradle += "'\n";

        }
    } else if (hasTypes) {
        type = type.trim();
        var types = type.split(" ");
        for (var i = 0; i < types.length; i++) {
            if (types[i].trim().length==0)
                continue;
            maventxt+= "<dependency>\n\t<groupId>" + group + "</groupId>\n\t<artifactId>" + artifact+
                "</artifactId>\n\t";
            maventxt += "<type>" + types[i].trim() + "</type>\n\t";
            maventxt +="<version>" + version + "</version>\n</dependency>\n";

            gradle += "compile '" + group + ":" + artifact + ":" + version;
            gradle += "@" + types[i];
            gradle += "'\n";

        }
    } else {
            //no type or classifiers
         maventxt+= "<dependency>\n\t<groupId>" + group + "</groupId>\n\t<artifactId>" + artifact+
                "</artifactId>\n\t";
         maventxt +="<version>" + version + "</version>\n</dependency>\n";
         gradle += "compile '" + group + ":" + artifact + ":" + version;
         gradle += "'\n";

    }

    $("#mavenDep").text(maventxt);
    $("#gradleDep").text(gradle);
    $('#modal1').modal()

}

$("table").addClass("table table-striped sortable");
$(function () {
    setNavigation();
});


/**
* this sets the "active" bit on the left hand side naviation menu
*/
function setNavigation() {
    var path = window.location.pathname;
    path = path.replace(/\/$/, "");
    path = decodeURIComponent(path);
    var idx=path.toString().lastIndexOf("/");
    if (idx >= 0)
        path=path.substring(idx+1, path.length);

    $(".nav a").each(function () {
        var href = $(this).attr('href');
        if (path.substring(0, href.length) === href) {
            $(this).closest('li').addClass('active');
        }
    });
}
</script>
</body>
</html>
